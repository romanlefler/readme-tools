#!/bin/sh
set -e

ROOT="$(cd "$(dirname "$0")/.." && pwd)"

VENV="$ROOT/.venv"
PY="$VENV/bin/python"
REQ="$ROOT/requirements.txt"
SCRIPT="$ROOT/scripts/po_progress.py"

# Create venv if missing
if [ ! -d "$VENV" ]; then
    echo 'First Run: Setting up Python virtual environment...' >&2
    python3 -m venv "$VENV"
    "$PY" -m pip install -U pip
    "$PY" -m pip install -r "$REQ"
    echo 'Environment setup complete.' >&2
fi

exec "$PY" "$SCRIPT" "$@"
